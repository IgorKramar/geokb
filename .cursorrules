# Правила работы с базой знаний по географии для GeoGuessr

## Структура vault

### Организация файлов
- **Единственная папка для заметок**: `./src/`
- **Никаких других папок** для организации заметок
- Все заметки находятся на одном уровне в `src/`
- **Этот репозиторий посвящён только географии**: все заметки относятся к географии, странам, городам и признакам для GeoGuessr

### Именование файлов
- **Формат**: `YYYYMMDD_descriptive-name.md`
- **Пример**: `20250101_russia.md`
- Timestamp в формате: год, месяц, день (8 цифр)
- Описательное имя на латинице, слова разделены дефисами
- Timestamp НЕ меняется после создания файла

## Формат ссылок

### Обязательные требования
- **Относительные ссылки**: `[Link](./filename.md)` формат
- **Ссылки внутри текста**: ссылки должны быть естественной частью текста, а не только в метаданных или в конце
- **НЕ создавать раздел "Связанные заметки"**: каждое упоминание связанной идеи становится ссылкой прямо в предложении
- **Работают вне Obsidian**: ссылки должны работать в любом Markdown редакторе и Git
- **Естественный поток**: ссылки не должны прерывать поток мысли, а быть её частью
- **Проверка существующих заметок**: перед созданием ссылки на топик/понятие/идею обязательно проверяю [MOC - Map of Content (География)](./src/20250101_moc-map-of-content-geography.md) — если заметка на эту тему уже существует, использую её имя файла для ссылки, чтобы избежать дубликатов
- **Проверка маппинга ссылок**: перед созданием новой ссылки обязательно проверяю файлы [LINK_MAPPING.md](./system/LINK_MAPPING.md) и [LINK_MAPPING.json](./system/LINK_MAPPING.json) на наличие существующих ссылок с похожим или альтернативным написанием — если такая ссылка уже существует, использую её вместо создания дубликата с другим написанием
- **Обновление маппинга ссылок**: после создания или изменения ссылок в заметках обязательно обновляю файлы [LINK_MAPPING.md](./system/LINK_MAPPING.md) и [LINK_MAPPING.json](./system/LINK_MAPPING.json), чтобы маппинг ссылок оставался актуальным

### Примеры правильных ссылок
```markdown
[Россия](./20250101_russia.md) — крупнейшая страна в мире.
[Дорожные знаки Европы](./20250101_road-signs-europe.md) имеют характерные особенности,
которые помогают определить местоположение в [GeoGuessr](./20250101_geoguessr-techniques.md).
```

## Тон и стиль заметок

### Форма изложения
- **От первого лица**: все заметки написаны так, будто пользователь сам их пишет
- **НЕ использовать**: "ты", "твой", "тебе", императивные формы ("делай", "создавай")
- **Использовать**: "я", "мой", "мне", формы от первого лица ("делаю", "создаю", "добавляю")

### Примеры
- ❌ "Создавай заметки с timestamp"
- ✅ "Создаю заметки с timestamp"
- ❌ "Твой vault должен..."
- ✅ "Мой vault должен..."

## Типы заметок

### Evergreen Notes (постоянные)
- Развивающиеся заметки с полной структурой
- Много связей
- Постоянно улучшаются
- **Все заметки по географии являются Evergreen Notes**

### Literature Notes (конспекты)
- Заметки о прочитанном материале по географии
- Привязаны к источнику
- Могут стать источником для Evergreen Notes

### Project Notes (проектные)
- Заметки, связанные с конкретным проектом по географии
- Временные, но важные

## Шаблоны

### Расположение
- Папка: `.obsidian/templates/`
- Доступные шаблоны:
  - `template-evergreen.md`
  - `template-literature.md`
  - `template-project.md`

### Использование
- Шаблоны используют плейсхолдеры: `{{title}}`, `{{date:YYYYMMDDHHmm}}`
- Все шаблоны написаны от первого лица
- Все шаблоны включают YAML FrontMatter с полем `title` для отображения в графе через плагин Front Matter Title
- **Все шаблоны для заметок по географии должны включать `topic: География`**

## MOC (Map of Content)

### Главный MOC
- Файл: `src/20250101_moc-map-of-content-geography.md`
- Точка входа в базу знаний по географии
- Регулярно обновляется

### MOC - Страны
- Файл: `src/20250101_moc-countries.md`
- Навигация по всем заметкам о странах
- Организована по регионам

### MOC - Города
- Файл: `src/20250101_moc-cities.md`
- Навигация по всем заметкам о городах
- Организована по регионам

### MOC - Признаки
- Файл: `src/20250101_moc-features.md`
- Навигация по всем заметкам о признаках
- Организована по типам признаков

## Принципы работы

### При создании заметок
1. Использовать timestamp-именование
2. Добавлять ссылки внутри текста (естественным потоком, не в разделе "Связанные заметки")
3. Писать от первого лица
4. Связывать с существующими заметками по географии

### При редактировании
1. Сохранять timestamp в имени файла
2. Обновлять ссылки при необходимости
3. Улучшать формулировки
4. Добавлять новые связи

### При рефакторинге
1. Объединять похожие заметки
2. Улучшать структуру
3. Обновлять связи
4. Удалять устаревшее

## Автоматизация

### Скрипты для создания заметок
- **Windows**: `python kb.py create-note -n "name" -t "template-evergreen"`
- **Unix/Linux/macOS**: `python3 kb.py create-note -n "name" -t "template-evergreen"`
- Скрипт автоматически создает файл с правильным именем и шаблоном

### Получение актуального timestamp

При создании заметок через скрипты или команды терминала необходимо получать актуальный timestamp в формате `YYYYMMDD`.

#### Определение операционной системы
Сначала определяем платформу:
- **Windows**: проверка через `$env:OS` или `$IsWindows` в PowerShell
- **Linux/Unix/macOS**: проверка через `uname` или переменную окружения

#### Команды для получения timestamp

**Windows (PowerShell):**
```powershell
Get-Date -Format "yyyyMMdd"
# Пример вывода: 20251201
```

**Linux/Unix/macOS (Bash):**
```bash
date +"%Y%m%d"
# Пример вывода: 20251201
```

#### Использование в скриптах

**PowerShell (Windows):**
```powershell
$timestamp = Get-Date -Format "yyyyMMdd"
$filename = "${timestamp}_${Name}.md"
```

**Bash (Linux/Unix/macOS):**
```bash
TIMESTAMP=$(date +"%Y%m%d")
FILENAME="${TIMESTAMP}_${NAME}.md"
```

#### Важно
- Timestamp должен быть актуальным на момент создания заметки
- Формат строго `YYYYMMDD` (8 цифр)
- Не использовать статичные значения или примеры
- Всегда получать через команды терминала, а не хардкодить

### Настройки Obsidian
- Плагин Templates включен
- Папка шаблонов: `.obsidian/templates`
- Формат даты: `YYYYMMDD`

## YAML FrontMatter

### Обязательные поля
- **title**: заголовок заметки для отображения в графе
- **type**: тип заметки (Evergreen, Literature, Project)
- **status**: статус заметки (IN PROGRESS, COMPLETE, TODO)
- **category**: категория заметки для тематической организации
- **topic: География**: **ОБЯЗАТЕЛЬНО** для всех заметок по географии
- Формат: `---\ntitle: Название\ntype: Evergreen\nstatus: IN PROGRESS\ncategory: Название категории\ntopic: География\n---`

### Типы заметок (type)
- **Evergreen**: постоянные развивающиеся заметки (основной тип для заметок по географии)
- **Literature**: конспекты прочитанного материала по географии
  - **Обязательные метаданные**: `source` (URL источника), `author` (если известен), `published` (дата публикации, если известна)
  - После завершения обработки текста на атомарные заметки статус меняется на `COMPLETE`
- **Project**: проектные заметки по географии

### Статусы заметок (status)
- **IN PROGRESS**: заметка в процессе разработки/улучшения
- **COMPLETE**: заметка завершена и готова к использованию
- **TODO**: заметка требует обработки или развития

### Категории заметок (category)
Категории для тематической организации заметок по географии:
- **Навигация**: навигационные заметки и MOC
- **География**: заметки о географии (страны, города, признаки, регионы, техники)
- Можно создавать новые категории по мере необходимости

### Использование
- Все заметки должны начинаться с YAML FrontMatter
- Плагин Front Matter Title использует поле `title` для отображения в графе
- Поля `type`, `status` и `category` помогают организовать и фильтровать заметки
- **Все заметки по географии должны иметь `topic: География` в YAML FrontMatter**
- Fallback: если `title` нет, используется H1 заголовок
- **Для Literature Notes**: обязательно указываю `source` (URL источника), `author` (если известен), `published` (дата публикации, если известна). После завершения обработки текста на атомарные заметки статус меняю на `COMPLETE`

## Важные правила

1. **Никогда не создавать папки** кроме `src/`
2. **Всегда использовать timestamp-именование** для новых заметок
3. **Всегда добавлять YAML FrontMatter** с полями `title`, `type`, `status`, `category` и **`topic: География`**
4. **Ссылки только относительные** в формате `[Text](./file.md)`
5. **Ссылки внутри текста**, а не только в конце
6. **Тон от первого лица** во всех заметках
7. **Не менять timestamp** в существующих файлах
8. **Связывать заметки** при создании и редактировании
9. **Обновлять статус** заметки по мере её развития (TODO → IN PROGRESS → COMPLETE)
10. **Все заметки в этом репозитории относятся к географии**

## Контекст для AI

При работе с этой базой знаний:
- Понимать, что это база знаний по географии для GeoGuessr
- Все заметки относятся к географии, странам, городам и признакам
- Следовать установленной структуре и форматам
- Писать заметки так, будто их пишет сам пользователь
- Использовать относительные ссылки
- Создавать атомарные заметки с одной идеей
- Всегда добавлять связи между заметками

### Работа с заметками по географии

При работе с заметками по географии необходимо следовать специальным рабочим процессам, описанным в системных файлах. Полное описание назначения всех системных файлов находится в [README.md](./README.md).

Рабочие процессы:

- **[Рабочий процесс обработки входящей информации по географии](./system/20251201_workflow-geography-incoming-info.md)** — основной процесс работы с новой информацией
- **[Рабочий процесс наполнения бедных на контент заметок по географии](./system/20251201_workflow-poor-content-enrichment.md)** — процесс наполнения заметок с малым количеством контента
- **[Рабочий процесс создания заметок по битым ссылкам по географии](./system/20251201_workflow-broken-links-creation.md)** — процесс создания заметок для отсутствующих ссылок
- **[Рабочий процесс факт-ревью базы знаний по географии](./system/20251201_workflow-fact-review.md)** — процесс проверки заметок на консистентность и выявления несоответствий

### Работа с вопросами для проработки темы

**КРИТИЧЕСКИ ВАЖНО**: При получении вопроса от пользователя для проработки аспекта географии, ИИ должен строго следовать рабочему процессу:

1. **Проверка на похожие вопросы**: **КРИТИЧЕСКИ ВАЖНО** — перед созданием новой карточки обязательно проверяю, нет ли уже похожего вопроса в папке `questions/`. Просматриваю все существующие файлы, читаю формулировки вопросов и сравниваю с новым вопросом. Если найден похожий вопрос, указываю пользователю на существующий и предлагаю использовать его или уточнить отличия.

2. **Определение порядкового номера**: Проверяю существующие файлы в папке `questions/` и определяю следующий свободный номер с ведущим нулем (01, 02, 03...)

3. **Поиск существующих заметок**: Ищу заметки, где упоминается концепция из вопроса, используя [MOC - Map of Content (География)](./src/20250101_moc-map-of-content-geography.md) и [LINK_MAPPING.md](./system/LINK_MAPPING.md)

4. **Поиск контекстных заметок**: Ищу связанные заметки, которые могут помочь понять контекст вопроса

5. **Подбор аналогий**: Подбираю исторические примеры, современные аналогии и научные факты, которые могут помочь продумать ответ на вопрос

6. **Создание карточки**: Создаю файл в папке `questions/` с именем `NN_question.md`, где `NN` — порядковый номер. Карточка должна содержать:
   - YAML FrontMatter с полями `title`, `type: Evergreen`, `status: TODO`, `category: География / Вопросы`, `topic: География`, `question_number: NN`
   - Раздел "Вопрос" с формулировкой вопроса
   - Раздел "Обоснование важности вопроса" с обоснованием
   - Раздел "Существующие заметки" с информацией о релевантных заметках
   - Раздел "Контекстные заметки" со списком связанных заметок
   - Раздел "Аналогии из реального мира" с историческими примерами и аналогиями

7. **Создание заготовки ответа**: Создаю файл в папке `answers/` с именем `NN_answer.md`, где `NN` — порядковый номер вопроса. Заготовка должна содержать:
   - YAML FrontMatter с полями `title`, `type: Evergreen`, `status: IN PROGRESS`, `category: География / Ответы`, `topic: География`, `question_number: NN`
   - Ссылку на карточку вопроса
   - Раздел "Ответ" (пустой, для заполнения пользователем)
   - Раздел "Проверка фактологии" (для ИИ)
   - Раздел "Проверка логики" (для ИИ)
   - Раздел "Соответствие теме" (для ИИ)
   - Раздел "Замечания и предложения" (для ИИ)

8. **Использование относительных ссылок**: Все ссылки на заметки должны быть относительными в формате `[Text](./src/filename.md)`

9. **Тон от первого лица**: Карточка написана от первого лица, как будто пользователь сам её создает

**Важно**: 
- Вопросы хранятся в папке `questions/` (это исключение из правила "никаких других папок кроме src/")
- Ответы хранятся в папке `answers/` (это исключение из правила "никаких других папок кроме src/")
- Порядковые номера не меняются после создания файла
- Статус карточки обновляется по мере проработки вопроса (TODO → IN PROGRESS → COMPLETE)

### Методология обработки текста по географии

**КРИТИЧЕСКИ ВАЖНО**: При работе с большими массивами текста о географии (статьи, главы книг, лекции, конспекты) ИИ должен строго следовать методологии:

1. **Разбиение на атомарные заметки**: Каждая идея, концепция, страна, город, признак или техника становится отдельной заметкой
2. **Проверка существующих заметок**: Перед созданием новой заметки проверяю [MOC - Map of Content (География)](./src/20250101_moc-map-of-content-geography.md) — если заметка на эту тему уже существует, использую её вместо создания дубликата
3. **Проверка маппинга ссылок**: Перед созданием новой ссылки проверяю файлы [LINK_MAPPING.md](./system/LINK_MAPPING.md) и [LINK_MAPPING.json](./system/LINK_MAPPING.json) на наличие существующих ссылок с похожим или альтернативным написанием — если такая ссылка уже существует, использую её вместо создания дубликата с другим написанием
4. **Ссылки внутри текста**: Все ссылки создаются естественным потоком внутри текста, а НЕ в разделе "Связанные заметки" в конце
5. **Естественные связи**: Каждое упоминание связанного понятия, страны, города или признака становится ссылкой прямо в предложении. При создании ссылки проверяю MOC-заметки и маппинг ссылок, чтобы использовать правильное имя файла существующей заметки
6. **Контекст важнее структуры**: Ссылки показывают связи в контексте, без необходимости в отдельном разделе
7. **Обновление MOC-заметок**: После создания заметок обязательно обновляю [MOC - Map of Content (География)](./src/20250101_moc-map-of-content-geography.md), добавляя ссылки на новые заметки в соответствующие разделы
8. **Обновление маппинга ссылок**: После создания или изменения ссылок в заметках обязательно обновляю файлы [LINK_MAPPING.md](./system/LINK_MAPPING.md) и [LINK_MAPPING.json](./system/LINK_MAPPING.json), чтобы маппинг ссылок оставался актуальным. Это помогает отслеживать все ссылки в базе знаний, включая битые ссылки на несуществующие заметки
9. **Git коммит и пуш**: После завершения всех работ по разбору текста на атомарные заметки, обновления MOC-заметок и маппинга ссылок обязательно выполняю git коммит и пуш. Получаю актуальный timestamp через команду терминала (`Get-Date -Format "yyyyMMdd"` для Windows или `date +"%Y%m%d"` для Linux/macOS), затем выполняю: `git add .`, `git commit -m '[TIMESTAMP] - [краткое описание на русском в одно предложение]'`, `git push`

**Пример правильного подхода:**
```markdown
[Россия](./20250101_russia.md) — крупнейшая страна в мире.
[Дорожные знаки Европы](./20250101_road-signs-europe.md) имеют характерные особенности,
которые помогают определить местоположение в [GeoGuessr](./20250101_geoguessr-techniques.md).
[Москва](./20250101_moscow.md) — столица [России](./20250101_russia.md).
```

**НЕПРАВИЛЬНО:**
- Создавать одну большую заметку из всего текста
- Добавлять раздел "Связанные заметки" в конце
- Делать ссылки только в списках, а не внутри текста
- Создавать заметки без `topic: География` в YAML FrontMatter

